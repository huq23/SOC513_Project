---
title: "Research Analysis Notebook"
---

```{r}
#| label: setup
#| include: false
library(here)
source(here("utils","check_packages.R"))
source(here("utils","functions.R"))
load(here("data","data_constructed","merged_data.RData"))
```

This quarto doc is used to analyze the data.


```{r}
#| label: fig-1
#| fig-cap: Shows the distribution violent crime rate across the United States 

ggplot(merged_data, aes(x=violent)) +
  geom_histogram(binwidth = 20, col = "black") +
  labs(x = "Violent Crime rate per 100,000 population") +
  theme_bw()

```
The histogram in @fig-1 illustrates the distribution of violent crime rate from 2017 to 2019 in the United States. The distribution is skewed to the right, with the majority of areas having violent crime rates less than 500 per 100,000 population.  


```{r}
#| label: fig-2
#| fig-cap: Shows the distribution violent crime rate across the United States 

ggplot(merged_data, aes(x=pct_below_poverty)) +
  geom_histogram(binwidth = 1, col = "black") +
  labs(x = "Percentage of people below poverty line") +
  theme_bw()

```
The histogram in @fig-2 shows the distribution of percentage of people below poverty line  from 2017 to 2019 in the United States. The distribution is skewed to the right, with the majority of areas having percentage of people below poverty line between 5% and 12%.   


```{r, warning=FALSE, message=FALSE}
#| label: fig-3
#| fig-cap: Shows a scatterplot of the relationship between percentacage of below poverty and violent crime rate accross the US

ggplot(merged_data, aes(x=pct_below_poverty, y=violent)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se =FALSE) +
  labs(x = "Poverty rate", y = "Violent crime rate") +
  theme_bw()

```
The scatterplot in @fig-3 illustrates the relationship between the poverty rate and violent crime rate in the United States from 2017 to 2019. The blue line depicts the best-fit Ordinary Least Squares (OLS) regression line, showing how the variables are related. This line suggests a positive correlation, indicating that as the poverty rate increases, the violent crime rate also tends to rise.  


```{r, warning=FALSE,message=FALSE}
#| label: tbl-1
#| tbl-cap: Model predicting the violent crime rate accross the US
#| results: asis
library(modelsummary)
model1 <- lm(violent ~ pct_below_poverty , data = merged_data)
model2 <- update(model1, .~.+pct_unemploy)
model3 <- update(model2, .~.+pct_lhs)



modelsummary(list(model1,model2,model3), 
             output = "gt",
             stars = c("*" = 0.05, "**"= 0.01, "***" =0.001),
             gof_map = c("nobs", "r.squared"),
             coef_map = c("(Intercept)"       = "Intercept",
                          "pct_below_poverty" = "Poverty rate",
                          "pct_unemploy"      = "Unemployment",
                          "pct_lhs"           = "Percentage of less than high school deploma"
                          ))

```




